SOL_coalition_menu = {
	coalition_current_resolution_decision = {	
		icon = GFX_decision_coalition_resolution
		priority = 100
		fire_only_once = no
		available = {
			hidden_trigger = { always = no }
		}
		activation = { always = no }
		days_mission_timeout = 5
		selectable_mission = no
		is_good = no

		timeout_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision timeout coalition_current_resolution_decision"
			if = {
				limit = { check_variable = { global.coalition_resolution_support_var > global.coalition_resolution_oppose_var } }
				custom_effect_tooltip = coalition_resolution_pass
			}
			else = {
				custom_effect_tooltip = coalition_resolution_fail
			}
			hidden_effect = {
				remove_mission = coalition_current_resolution_decision_support
				remove_mission = coalition_current_resolution_decision_oppose
				remove_mission = coalition_current_resolution_decision
			}
		}		
	}
	coalition_current_resolution_decision_support = {	
		icon = GFX_decision_coalition_resolution_support
		priority = 99
		fire_only_once = no
		available = {
			custom_trigger_tooltip = {
				tooltip = ongoing_resolution
				has_active_mission = coalition_current_resolution_decision
			}
		}
		visible = {
			hidden_trigger = {	
				has_active_mission = coalition_current_resolution_decision
				has_active_mission = coalition_current_resolution_decision_oppose
			}
		}
		ai_will_do = {
			base = 10
			modifier = {
				add = 10
				event_target:proposed_resolution_nation = { is_ai = no }
			}
			modifier = {
				add = -10
				if = {	
					limit = { has_global_flag = proposal_coalition_invite_members }
					event_target:potential_new_member = { NOT = { has_government = ROOT } }
				}
			}
			modifier = {
				add = 10
				has_global_flag = proposal_coalition_fortress
				is_neighbor_of = EQS
			}
			modifier = {
				add = 10
				has_global_flag = proposal_coalition_research
			}
		}
		allowed = {
			always = no
		}
		days_mission_timeout = 5
		selectable_mission = yes
		is_good = yes

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision complete coalition_current_resolution_decision_support"
			hidden_effect = {
				add_to_variable = { var = global.coalition_resolution_support_var value = 1 }
				remove_mission = coalition_current_resolution_decision_oppose
				add_to_array = {
					array = global.coalition_countries_voting_yes
					value = THIS
				}
			}
		}		
	}
	coalition_current_resolution_decision_oppose = {	
		icon = GFX_decision_coalition_resolution_oppose
		priority = 98
		fire_only_once = no
		available = {
			custom_trigger_tooltip = {
				tooltip = ongoing_resolution
				has_active_mission = coalition_current_resolution_decision
			}
		}
		visible = {
			hidden_trigger = {	
				has_active_mission = coalition_current_resolution_decision
				has_active_mission = coalition_current_resolution_decision_support
			}
		}
		ai_will_do = {
			base = 10
			modifier = {
				add = 5
				has_global_flag = proposal_coalition_defensive_plan
				event_target:proposed_resolution_nation = { NOT = { has_government = ROOT } }
			}
			modifier = {
				add = 10
				has_global_flag = proposal_coalition_fortress
				NOT = { is_neighbor_of = EQS }
			}
		}
		allowed = {
			always = no
		}
		days_mission_timeout = 5
		selectable_mission = yes
		is_good = no

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision complete coalition_current_resolution_decision_oppose"
			hidden_effect = {
				add_to_variable = { var = global.coalition_resolution_oppose_var value = 1 }
				remove_mission = coalition_current_resolution_decision_support
				add_to_array = {
					array = global.coalition_countries_voting_no
					value = THIS
				}
			}
		}		
	}
	coalition_defensive_plan_project = {
		icon = GFX_decision_mark_states
		priority = 90
		fire_only_once = no
		ai_will_do = {
			factor = 200
			modifier = {
				factor = 0 
				has_war = yes
			}
		}
		visible = {
			hidden_trigger = {
				is_coalition_member = yes
				has_global_flag = coalition_defensive_plan_accepted
			}
		}
		available = {
			has_army_manpower = {
				size > 50000
			}
			custom_trigger_tooltip = {
				tooltip = no_ongoing_commitments
				NOT = {
					has_idea = coalition_defensive_plan_project_commitment
					has_idea = coalition_fortress_project_commitment
				}
			}
			custom_trigger_tooltip = {
				tooltip = max_commitments
				check_variable = { global.coalition_defensive_plan_project_commitment_num < 5 }
			}
		}
		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision coalition_defensive_plan_project"
			add_timed_idea = {
				idea = coalition_defensive_plan_project_commitment
				days = 60
			}
		}
	}
	coalition_defensive_plan_propose = {
		icon = GFX_decision_mark_states
		priority = 80
		fire_only_once = no
		ai_will_do = {
			factor = 200
		}
		visible = {
			hidden_trigger = {
				is_a_player_in_coalition = yes
				NOT = { has_global_flag = coalition_defensive_plan_rejected }
				NOT = { has_global_flag = coalition_defensive_plan_accepted }
				NOT = { has_global_flag = coalition_defensive_plan_completed }
			}
		}
		available = {
			custom_trigger_tooltip = {
				tooltip = no_ongoing_resolution
				NOT = { has_active_mission = coalition_current_resolution_decision }
			}
			custom_trigger_tooltip = {
				tooltip = no_ongoing_project
				NOT = { has_global_flag = coalition_ongoing_project }
			}
		}
		allowed = {
			always = yes
		}
		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision coalition_defensive_plan_propose"
			set_global_flag = proposal_coalition_defensive_plan
			set_global_flag = proposal_coalition_active
			hidden_effect = { 
				every_country = {
					limit = {
						is_coalition_member = yes
					}
					activate_mission = coalition_current_resolution_decision
					activate_mission = coalition_current_resolution_decision_support
					activate_mission = coalition_current_resolution_decision_oppose
				}
				country_event = {
					id = coalition.11
					days = 5
				}
				every_country = {
					limit = {
						is_coalition_member = yes
						NOT = { tag = ROOT }
					}
					set_variable = { var = sol_coalition_alert_popup_show value = 0.5 }
				}
			}
			ROOT = {	
				save_global_event_target_as = proposed_resolution_nation
			}
		}
	}
	coalition_fortress_project = {
		icon = GFX_decision_bunker
		priority = 89
		fire_only_once = no
		ai_will_do = {
			factor = 200
			modifier = {
				factor = 0.1
				num_of_civilian_factories < 20
			}
		}
		visible = {
			hidden_trigger = {
				is_coalition_member = yes
				has_global_flag = coalition_fortress_accepted
			}
		}
		available = {
			num_of_civilian_factories > 9
			custom_trigger_tooltip = {
				tooltip = no_ongoing_commitments
				NOT = {
					has_idea = coalition_defensive_plan_project_commitment
					has_idea = coalition_fortress_project_commitment
				}
			}
			custom_trigger_tooltip = {
				tooltip = max_commitments
				check_variable = { global.coalition_fortress_project_commitment_num < 5 }
			}
		}
		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision coalition_fortress_project"
			add_timed_idea = {
				idea = coalition_fortress_project_commitment
				days = 60
			}
		}
	}
	coalition_fortress_propose = {
		icon = GFX_decision_bunker
		priority = 79
		fire_only_once = no
		ai_will_do = {
			factor = 200
		}
		visible = {
			hidden_trigger = {
				is_a_player_in_coalition = yes
				NOT = { has_global_flag = coalition_fortress_rejected }
				NOT = { has_global_flag = coalition_fortress_accepted }
				NOT = { has_global_flag = coalition_fortress_completed }
			}
		}
		available = {
			custom_trigger_tooltip = {
				tooltip = no_ongoing_resolution
				NOT = { has_active_mission = coalition_current_resolution_decision }
			}
			custom_trigger_tooltip = {
				tooltip = no_ongoing_project
				NOT = { has_global_flag = coalition_ongoing_project }
			}
		}
		allowed = {
			always = yes
		}
		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision coalition_fortress_propose"
			set_global_flag = proposal_coalition_fortress
			set_global_flag = proposal_coalition_active
			hidden_effect = { 
				every_country = {
					limit = {
						is_coalition_member = yes
					}
					activate_mission = coalition_current_resolution_decision
					activate_mission = coalition_current_resolution_decision_support
					activate_mission = coalition_current_resolution_decision_oppose
				}
				country_event = {
					id = coalition.11
					days = 5
				}
				every_country = {
					limit = {
						is_coalition_member = yes
						NOT = { tag = ROOT }
					}
					set_variable = { var = sol_coalition_alert_popup_show value = 1 }
				}
			}
			ROOT = {	
				save_global_event_target_as = proposed_resolution_nation
			}
		}
	}
	coalition_research_propose = {
		icon = GFX_decision_generic_research
		priority = 78
		fire_only_once = no
		ai_will_do = {
			factor = 200
		}
		visible = {
			hidden_trigger = {
				is_a_player_in_coalition = yes
				NOT = { has_global_flag = coalition_research_rejected }
				NOT = { has_global_flag = coalition_research_accepted }
				NOT = { has_global_flag = coalition_research_completed }
			}
		}
		available = {
			custom_trigger_tooltip = {
				tooltip = no_ongoing_resolution
				NOT = { has_active_mission = coalition_current_resolution_decision }
			}
			custom_trigger_tooltip = {
				tooltip = no_ongoing_project
				NOT = { has_global_flag = coalition_ongoing_project }
			}
		}
		allowed = {
			always = yes
		}
		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision coalition_research_propose"
			set_global_flag = proposal_coalition_research
			set_global_flag = proposal_coalition_active
			hidden_effect = { 
				every_country = {
					limit = {
						is_coalition_member = yes
					}
					activate_mission = coalition_current_resolution_decision
					activate_mission = coalition_current_resolution_decision_support
					activate_mission = coalition_current_resolution_decision_oppose
				}
				country_event = {
					id = coalition.11
					days = 5
				}
				every_country = {
					limit = {
						is_coalition_member = yes
						NOT = { tag = ROOT }
					}
					set_variable = { var = sol_coalition_alert_popup_show value = 1 }
				}
			}
			ROOT = {	
				save_global_event_target_as = proposed_resolution_nation
			}
		}
	}
	coalition_invite_members = {
		icon = GFX_decision_resistance_attack
		priority = 10
		cost = 20
		fire_only_once = no
		ai_will_do = {
			factor = 160
		}
		visible = {
			hidden_trigger = {
				is_a_player_in_coalition = yes
				any_country = {	
					is_eligible_for_coalition = yes
				}
			}
		}
		allowed = {
			always = yes
		}
		available = {
			custom_trigger_tooltip = {
				tooltip = no_ongoing_resolution
				NOT = { has_active_mission = coalition_current_resolution_decision }
			}
		}
		targets = { EQC STG DRG CRY YAK JAK GRF PNG PLB CHN OLE }
		targets_dynamic = yes
		target_trigger = {
			FROM = { 
				OR = {
					original_tag = EQC
					original_tag = STG
					original_tag = DRG
					original_tag = CRY
					original_tag = YAK
					original_tag = JAK
					original_tag = GRF
					original_tag = PNG
					original_tag = PLB
					original_tag = CHN
					original_tag = OLE
				}
				is_eligible_for_coalition = yes
				is_coalition_member = no
			}
		}
		target_root_trigger = {
			is_coalition_member = yes
		}
		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision coalition_invite_members target: [From.GetName]"
			set_global_flag = proposal_coalition_invite_members
			set_global_flag = proposal_coalition_active
			
			hidden_effect = { 
				every_country = {
					limit = {
						is_coalition_member = yes
					}
					activate_mission = coalition_current_resolution_decision
					activate_mission = coalition_current_resolution_decision_support
					activate_mission = coalition_current_resolution_decision_oppose
				}
				country_event = {
					id = coalition.11
					days = 5
				}
				every_country = {
					limit = {
						is_coalition_member = yes
						NOT = { tag = ROOT }
					}
					set_variable = { var = sol_coalition_alert_popup_show value = 0.5 }
				}
			}
			FROM = {
				save_global_event_target_as = potential_new_member
			}
			ROOT = {	
				save_global_event_target_as = proposed_resolution_nation
			}
		}
	}
}