on_actions = {
	on_nuke_drop = {
		effect = {
			if = {
				limit = { FROM = { NOT = { has_state_flag = skip_nuke_alert } } }
				FROM = { 
					owner = { 
						PREV = { save_global_event_target_as = nuked_state } 
						ROOT = { save_global_event_target_as = nuker_country } 
						clear_variable = sol_alert_popup_show
						set_variable = { sol_alert_title_var = 4 }
						set_variable = { sol_alert_desc_var = 11 }
						set_variable = { var = sol_alert_popup_show value = 1 }
					} 
				}
			}
			else = {
				FROM = { clr_state_flag = skip_nuke_alert }
			}
		}
	}
	on_state_control_changed = {
		effect = {
			FROM = {
				save_event_target_as = former_controller
			}
			if = {
				limit = {
					FROM = { tag = NLR }
					ROOT = { is_SOLAR_EMPIRE = yes }
				}
				FROM.FROM = {	
					save_global_event_target_as = SOL_NLR_last_state
				}
			}
			if = {
				limit = {
					has_war_with = FROM
					has_country_flag = sol_turning_the_tide
					has_country_leader = { ruling_only = yes name = "Daybreaker" }
					FROM.FROM = {
						has_state_flag = SOL_state_fall
					}
				}
				add_to_variable = { var = daybreaker_support value = 3 }
				FROM.FROM = {
					clr_state_flag =  SOL_state_fall
				}
				hidden_effect = { SOL_calculate_loyalty = yes }
			}
			if = {
				limit = {
					has_war_with = FROM
					has_country_leader = { ruling_only = yes name = "Daybreaker" }
					NOT = { has_country_flag = SOL_reconstruction_complete }
					FROM.FROM = {
						has_variable = SOL_public_works_region_id
						NOT = { has_state_flag = SOL_wartorn_state }
					}
				}
				FROM.FROM = {
					set_state_flag =  SOL_wartorn_state
				}
			}
			if = {
				limit = {
					FROM = { is_SOLAR_EMPIRE = yes }
					FROM.FROM = { has_state_flag = SOL_overrun_by_resistance }
				}
				FROM.FROM = {
					clr_state_flag = SOL_overrun_by_resistance 
					add_core_of = EQS
				}
			}
			if = {
				limit = {
					has_war_with = FROM
					FROM = { has_country_leader = { ruling_only = yes name = "Daybreaker" } }
					FROM.FROM = {
						is_owned_by = event_target:solar_empire
						OR = {
							state = 132 #Shire
							state = 66 #Los Pegasus
							state = 75 #Manehattan
							state = 3 #Canterlot
							state = 14 #Vanhoover
							state = 59 #Tall Tale
							state = 13 #Baltimare
							state = 136 #Acornage
							state = 12 #Fillydelphia
							state = 70 #Whinnyapolis
							state = 74 #Bales
							state = 38 #Rockville
							state = 525 #Albion
							state = 2 #Ponyville
						}
						NOT = { has_state_flag = SOL_timeout }

					}
				}
				FROM = {
					add_to_variable = { var = daybreaker_support value = -3 } #Support is lost if Daybreaker loses key cities
					hidden_effect = { SOL_calculate_loyalty = yes }
				}
				FROM.FROM = { 
					set_state_flag = SOL_timeout
				}
			}
		}
	}
	on_weekly_EQS = {
		effect = {
			if = {
				limit = { NOT = { has_country_flag = resistance_ceasefire } }
				add_to_variable = { var = SOL_lead_variable value = weekly_leads }
			}
			
			if = {
				limit = {
					is_SOLAR_EMPIRE = yes
					NOT = { has_country_flag = resistance_ceasefire }
					has_country_flag = march_on_canterlot
				}
				random_list = {
					1 = {
						modifier = {
							factor = 0
							OR = {
								NOT = { has_country_flag = SOL_resistance_begins }
								check_variable = { resistance_attack_blocked > 0 }
								has_country_flag = resistance_ceasefire
							}
						}
						clear_variable = sol_alert_popup_show
						SOL_calculate_resistance_target = yes
						random_list = {
							1 = {
								set_variable = { outreach_strength_calculation_temp = solar_resistance_strength }
								divide_variable = { outreach_strength_calculation_temp = 5 }
								SOL_calculate_probability = yes
								if = {
									limit = { has_country_flag = civilian_informants }
									add_to_variable = { var = outreach_strength_calculation_temp value = -0.05 }
								}
								if = {
									limit = { has_completed_focus = SOL_decentralised_inquisitorial_policing }
									add_to_variable = { var = outreach_strength_calculation_temp value = -0.1 }
								}
								if = {
									limit = { event_target:SOL_resistance_activity = { has_dynamic_modifier = { modifier = SOL_infrastructure_hardening_bonus } } }
									add_to_variable = { var = outreach_strength_calculation_temp value = -0.1 }
								}
								if = {
									limit = { has_idea = SOL_changeling_interferance }
									add_to_variable = { var = outreach_strength_calculation_temp value = 0.3 }
								}
								if = {
									limit = { check_variable = { outreach_strength_calculation_temp > probability_check } }
									set_variable = { sol_alert_outcome_var = 2 }
									add_to_variable = { var = solar_resistance_outreach_actions_progress value = 1 }
								}
								else = {
									set_variable = { sol_alert_outcome_var = 1 }
									SOL_calculate_leads_small = yes
									add_to_variable = { var = SOL_lead_variable value = lead_counter }
								}
								set_variable = { sol_alert_desc_var = 1 }
							}
							1 = {
								set_variable = { civilian_strength_calculation_temp = solar_civilian_support }
								divide_variable = { civilian_strength_calculation_temp = 5 }
								SOL_calculate_probability = yes
								if = {
									limit = { has_country_flag = civilian_informants }
									add_to_variable = { var = civilian_strength_calculation_temp value = 0.05 }
								}
								if = {
									limit = { has_completed_focus = SOL_decentralised_inquisitorial_policing }
									add_to_variable = { var = civilian_strength_calculation_temp value = 0.1 }
								}
								if = {
									limit = { event_target:SOL_resistance_activity = { has_dynamic_modifier = { modifier = SOL_infrastructure_hardening_bonus } } }
									add_to_variable = { var = civilian_strength_calculation_temp value = 0.1 }
								}
								if = {
									limit = { has_idea = SOL_changeling_interferance }
									add_to_variable = { var = civilian_strength_calculation_temp value = -0.3 }
								}
								if = { 
									limit = { check_variable = { civilian_strength_calculation_temp > probability_check } }
									set_variable = { sol_alert_outcome_var = 1 }
									SOL_calculate_leads_small = yes
									add_to_variable = { var = SOL_lead_variable value = lead_counter }
								}
								else = {
									set_variable = { sol_alert_outcome_var = 2 }
									add_to_variable = { var = solar_resistance_actions_progress value = 1 }
								}
								set_variable = { sol_alert_desc_var = 2 }
							}
							1 = {
								set_variable = { military_strength_calculation_temp = solar_military_support }
								divide_variable = { military_strength_calculation_temp = 5 }
								SOL_calculate_probability = yes
								if = {
									limit = { has_country_flag = civilian_informants }
									add_to_variable = { var = military_strength_calculation_temp value = 0.05 }
								}
								if = {
									limit = { has_completed_focus = SOL_decentralised_inquisitorial_policing }
									add_to_variable = { var = military_strength_calculation_temp value = 0.1 }
								}
								if = {
									limit = { event_target:SOL_resistance_activity = { has_dynamic_modifier = { modifier = SOL_infrastructure_hardening_bonus } } }
									add_to_variable = { var = military_strength_calculation_temp value = 0.1 }
								}
								if = {
									limit = { has_idea = SOL_changeling_interferance }
									add_to_variable = { var = military_strength_calculation_temp value = -0.3 }
								}
								if = { 
									limit = { check_variable = { military_strength_calculation_temp > probability_check } }
									set_variable = { sol_alert_outcome_var = 1 }
									SOL_calculate_leads_small = yes
									add_to_variable = { var = SOL_lead_variable value = lead_counter }
								}
								else = {
									set_variable = { sol_alert_outcome_var = 2 }
									add_to_variable = { var = solar_resistance_actions_progress value = 1 }
								}
								set_variable = { sol_alert_desc_var = 3 }
							}
						}
						set_variable = { sol_alert_title_var = 1 }
						set_variable = { var = sol_alert_popup_show value = 1 }
					}
					3 = {
						#Random blank to create weeks where nothing happens
					}
				}
				random_list = {
					1 = {
						modifier = {
							factor = 0
							has_country_flag = SOL_benevolent_public_timeout
						}					
						country_event = {
							id = paxsolaris.50 	#Benign public support event
						}				
					}
					3 = {
						#Random blank to create weeks where nothing happens
					}
				}
			}
			if = {
				limit = {
					has_completed_focus = SOL_economic_miracle
					check_variable = {
						var = num_of_factories
						value = SOL_next_growth_stage
						compare = greater_than_or_equals
					}
				}
				set_variable = { SOL_next_growth_stage = num_of_factories }
				multiply_variable = { SOL_next_growth_stage = 1.1 }
				round_variable = SOL_next_growth_stage
				add_to_variable = { SOL_next_growth_stage = 1 }
				set_variable = { SOL_number_of_factories_gained = num_of_factories }
				divide_variable = { SOL_number_of_factories_gained = 100 }
				round_variable = SOL_number_of_factories_gained
				add_to_variable = { SOL_number_of_factories_gained = 1 }
				add_offsite_building = { type = industrial_complex level = SOL_number_of_factories_gained }
			}
		}
	}
	on_daily_EQS = {
		effect = {
			if = {
				limit = {
					tag = EQS
					EQS = { exists = yes }
					has_country_leader = { ruling_only = yes name = "Daybreaker" }
				}
				SOL_calculate_law_loyalty = yes
				if = {
					limit = { NOT = { has_country_flag = resistance_ceasefire } }
					hidden_effect = { SOL_calculate_loyalty = yes }
					add_to_variable = { var = daybreaker_support value = daybreaker_support_daily }
				}
				
				#Magic reserves
				if = {
					limit = {
						EQS = { has_completed_focus = SOL_Imperium_Solis }
					}
					hidden_effect = { SOL_calculate_magic = yes }
					add_to_variable = { var = daybreaker_magic_reserves value = daybreaker_magic_daily_change }
					clamp_variable = {
						var = daybreaker_magic_reserves
						min = 0 
						max = daybreaker_magic_max
					}
					if = {
						limit = {
							check_variable = { daybreaker_magic_reserves = 0 }
						}
						every_state = {
							limit = {
								has_state_flag = SOL_state_has_spell_heatwave
							}
							custom_effect_tooltip = SOL_remove_heatwave_tt
							hidden_effect = {
								clr_state_flag = SOL_state_has_spell_heatwave
								remove_province_modifier = {
									static_modifiers = {
										SOL_heatwave_effect
									}
									province = {
										all_provinces = yes
									}
								}
								set_variable = { var = wrath_of_sun_icon_var value = 1 }
							}
						}
						every_country = {
							limit = {
								has_idea = SOL_blessing_of_day_idea
							}
							remove_ideas = SOL_blessing_of_day_idea
						}
						every_country = {
							limit = {
								has_idea = SOL_curse_of_day_idea
							}
							remove_ideas = SOL_curse_of_day_idea
						}
						EQS = {
							set_variable = { var = sol_curse_number value = 0 }
							set_variable = { var = sol_blessing_number value = 0 }
							set_variable = { var = sol_heatwave_number value = 0 }
							SOL_calculate_magic = yes
						}
					}
					if = {
						limit = {
							has_variable = sol_magic_screen_show
						}
						add_to_variable = { var = sol_magic_screen_show value = 1 }
					}
				}

				#Public Works
				if = {
					limit = {
						EQS = { 
							has_country_flag = sol_has_unlocked_public_works 
						}
					}
					SOL_calculate_region_development = yes
					if = {
						limit = {
							check_variable = { sol_ongoing_public_works_num > 0 }
						}
						if = {
							limit = { 
								has_war = no #Public Works are put on hold when there is an ongoing war
								NOT = { has_idea = SOL_worker_strikes }
							}
							for_each_loop = {
								array = SOL_ongoing_public_works
								value = current_region
								add_to_variable = { var = SOL_public_works_duration_array^current_region value = -1 }
							}
							for_each_loop = {
								array = SOL_ongoing_urban_planning
								value = current_region
								add_to_variable = { var = SOL_public_works_duration_array^current_region value = -1 }
							}
							for_each_loop = {
								array = SOL_ongoing_agmech
								value = current_region
								add_to_variable = { var = SOL_public_works_duration_array^current_region value = -1 }
							}
						}
						if = {
							limit = {
								NOT = { has_idea = SOL_worker_strikes }
							}
							for_each_loop = {
								array = SOL_ongoing_infrastructure_hardening
								value = current_region
								add_to_variable = { var = SOL_public_works_duration_array^current_region value = -1 }
							}
						}
						SOL_calculate_public_works_progress = yes
						if = {
							limit = {
								NOT = { EQS = { has_dynamic_modifier = { modifier = SOL_public_works_modifier } } }
							}
							add_dynamic_modifier = { modifier = SOL_public_works_modifier }
						}
					}
					else_if = {
						limit = {
							EQS = { has_dynamic_modifier = { modifier = SOL_public_works_modifier } }
						}
						remove_dynamic_modifier = { modifier = SOL_public_works_modifier }
					}
				}

				#Resistance Block
				if = {
					limit = { check_variable = { resistance_attack_blocked > 0 } }
					subtract_from_variable = { resistance_attack_blocked = 1 }
				}

				#Sarin Attack
				if = {
					limit = { has_variable = sol_gas_attack_cooldown }
					subtract_from_variable = { sol_gas_attack_cooldown = 1 }
					if = {
						limit = { 
							check_variable = { sol_gas_attack_cooldown < 91 } 
							event_target:SOL_gassed_state = { has_dynamic_modifier = { modifier = SOL_gas_attack } }
						}
						event_target:SOL_gassed_state = {
							remove_dynamic_modifier = { modifier = SOL_gas_attack } 
							remove_province_modifier = {	
								static_modifiers = { SOL_gas_attack_province }
								province = { all_provinces = yes }
							}
						}
					}
					if = {
						limit = { check_variable = { sol_gas_attack_cooldown < 1 } }
						clear_variable = sol_gas_attack_cooldown
					}
				}

				#Compliance Limit/Base/Core
				every_state = {
					limit = {
						has_variable = sol_compliance_limit
						is_controlled_by = EQS
						NOT = { is_core_of = EQS }
						check_variable = { compliance > sol_compliance_limit }
					}
					set_compliance = sol_compliance_limit 
				}
				every_state = {
					limit = {
						has_variable = sol_compliance_base
						is_controlled_by = EQS
						NOT = { is_core_of = EQS }
						check_variable = { compliance < sol_compliance_base }
					}
					set_compliance = sol_compliance_base 
				}
				every_state = {
					limit = {
						has_variable = sol_compliance_to_core
						is_controlled_by = EQS
						NOT = { is_core_of = EQS }
						check_variable = {
							var = compliance
							value = sol_compliance_to_core
							compare = greater_than_or_equals
						}
					}
					add_core_of = EQS
					clear_variable = sol_compliance_to_core
					clear_variable = sol_compliance_base
					clear_variable = sol_compliance_limit
					SOL_remove_uprising = yes
					if = {
						limit = { has_state_flag = SOL_add_dissatisfied_natives }
						add_dynamic_modifier = { modifier = SOL_dissatisfied_natives }
						clr_state_flag = SOL_add_dissatisfied_natives
					}
				}

				#Gamer Moments
				if = {
					limit = { check_variable = { EQS.sol_states_with_genocide^num > 0 } }
					for_each_loop = {
						array = sol_states_with_genocide
						value = current_state
						var:current_state = {
							if = {
								limit = { 
									is_controlled_by = EQS 
								}
								set_temp_variable = { var = sol_non_pony_population_change_temp value = -2.5 }
								hidden_effect = { SOL_pony_population_recalculate = yes }
								add_manpower = -2500
								subtract_from_variable = { var = sol_genocide_duration value = 1 }
								if = {
									limit = {
										check_variable = {
											var = sol_genocide_duration
											value = 0
											compare = less_than_or_equals
										}
									}
									add_to_array = { EQS.sol_completed_genocide = THIS }
								}
							}
							
						}
					}
					for_each_loop = {
						array = sol_completed_genocide
						value = current_state
						var:current_state = {
							remove_from_array = { EQS.sol_states_with_genocide = THIS }
							remove_dynamic_modifier = { modifier = SOL_genocide } 
							set_state_flag = SOL_completed_genocide
							force_disable_resistance = EQS
							SOL_remove_uprising = yes
							if = {
								limit = {
									has_dynamic_modifier = { modifier = SOL_extensive_pony_settlement }
								}
								add_core_of = EQS
							}
							set_variable = { sol_majority_race_id = 1 }
							SOL_genocide_custom_effects = yes
						}	
					}
					clear_array = sol_completed_genocide
				}
			}
		}
	}
	on_declare_war = {
		effect = {
			log = "[GetDateText]: ROOT: [Root.GetName] FROM: [From.GetName] on_declare_war"
			hidden_effect = {
				if = {
					limit = {
						FROM = {
							is_in_faction = yes
							is_coalition_member = yes
						}
						ROOT = {
							is_SOLAR_EMPIRE = yes
						}
					}
					FROM = { 
						save_global_event_target_as = coalition_defender 
					}
					every_country = {
						limit = {
							NOT = { tag = FROM }
							is_in_faction_with = FROM
							is_subject = no
							is_coalition_member = yes
						}
						country_event = {
							id = coalition.10
							days = 1
						}
					}
				}
				if = {
					limit = {
						FROM = {
							is_SOLAR_EMPIRE = yes
							has_country_flag = march_on_canterlot
							NOT = { has_country_flag = resistance_ceasefire }
						}
						ROOT = {
							has_government = fascism
							strength_ratio = {
								tag = EQS
								ratio > 0.5
							}
						}
					}
					ROOT = { save_global_event_target_as = sol_resistance_enemy }
					FROM = {
						country_event = {
							id = paxsolaris.37 #If Daybreaker has been attacked by another oppressive country (Crysalis, Sombra, Dark Wing ect) the resistance will temporarily cease their efforts to undermine her
							days = 2
						}
						set_country_flag = resistance_ceasefire
						remove_ideas = SOL_public_hostility_0
						remove_ideas = SOL_public_hostility_1
						remove_ideas = SOL_public_hostility_2
						remove_ideas = SOL_public_hostility_3
						remove_ideas = SOL_public_hostility_4
						remove_ideas = SOL_public_hostility_5
						remove_ideas = SOL_military_desertion_0
						remove_ideas = SOL_military_desertion_1
						remove_ideas = SOL_military_desertion_2
						remove_ideas = SOL_military_desertion_3
						remove_ideas = SOL_military_desertion_4
						remove_ideas = SOL_military_desertion_5
						remove_ideas = SOL_resistance_strength_0
						remove_ideas = SOL_resistance_strength_1
						remove_ideas = SOL_resistance_strength_2
						remove_ideas = SOL_resistance_strength_3
						remove_ideas = SOL_resistance_strength_4
						remove_ideas = SOL_resistance_strength_5
						remove_ideas = SOL_harmonist_broadcasts_0
						remove_ideas = SOL_harmonist_broadcasts_1
						remove_ideas = SOL_harmonist_broadcasts_2
						remove_ideas = SOL_harmonist_broadcasts_3
						remove_ideas = SOL_harmonist_broadcasts_4
						remove_ideas = SOL_harmonist_broadcasts_5
						remove_ideas = SOL_resistance_cohesion_1
						remove_ideas = SOL_resistance_cohesion_2
						remove_ideas = SOL_resistance_cohesion_3
						every_state ={
							clr_state_flag = resistance_attack_dummy_target
							clr_state_flag = resistance_attack_true_target
						}
						clear_array = EQS.SOL_resistance_attack_target_array
						clr_country_flag = SOL_has_ongoing_attack
						remove_mission = SOL_resistance_attack
						clr_country_flag = SOL_has_ongoing_cohesion
						remove_mission = SOL_resistance_cohesion
						set_variable = { var = solar_resistance_cohesion value = 0 }
					}
				}
			}
		}
	}
	on_offer_join_faction = {
		effect = {
			log = "[GetDateText] [Root.GetName] on_offer_join_faction FROM = [From.GetName]"
			if = {
				limit = {
					is_coalition_member = yes
					is_in_faction_with = FROM
					FROM = {
						NOT = { has_idea = SOL_coalition_member }
					}
				}
				FROM = {
					add_ideas = SOL_coalition_member
					if = {
						limit = { has_global_flag = coalition_defensive_plan_completed }
						add_ideas = coalition_defensive_plan_project_bonus
					}
					if = {
						limit = { has_global_flag = coalition_high_command_completed }
						add_ideas = coalition_high_command_project_bonus
					}
					if = {
						limit = { has_global_flag = coalition_expeditionary_forces_completed }
						add_ideas = coalition_expeditionary_forces_project_bonus
					}
					if = {
						limit = { has_global_flag = coalition_research_completed }
						add_to_tech_sharing_group = coalition_of_free_tech_share
					}
				}
			}
		}
	}
	on_join_faction = {
		effect = {
			log = "[GetDateText] [Root.GetName] on_join_faction FROM = [From.GetName]"
			if = {
				limit = {
					is_coalition_member = yes
					is_in_faction_with = FROM
					FROM = {
						NOT = { has_idea = SOL_coalition_member }
					}
				}
				FROM = {
					add_ideas = SOL_coalition_member
					if = {
						limit = { has_global_flag = coalition_defensive_plan_completed }
						add_ideas = coalition_defensive_plan_project_bonus
					}
					if = {
						limit = { has_global_flag = coalition_high_command_completed }
						add_ideas = coalition_high_command_project_bonus
					}
					if = {
						limit = { has_global_flag = coalition_expeditionary_forces_completed }
						add_ideas = coalition_expeditionary_forces_project_bonus
					}
					if = {
						limit = { has_global_flag = coalition_research_completed }
						add_to_tech_sharing_group = coalition_of_free_tech_share
					}
				}
			}
		}
	}
	on_leave_faction = {
		effect = {
			log = "[GetDateText] [Root.GetName] on_leave_faction FROM = [From.GetName]"
			if = {
				limit = {
					is_coalition_member = yes
					FROM = {
						is_coalition_member = yes
					}
				}
				remove_ideas = {
					SOL_coalition_member
					SOL_coalition_surrender
					coalition_defensive_plan_project_bonus
					coalition_high_command_project_bonus
					coalition_expeditionary_forces_project_bonus
					coalition_recognise_hrm_project_bonus_1
					coalition_recognise_hrm_project_bonus_2
					coalition_recognise_hrm_project_bonus_3
					coalition_recognise_hrm_project_bonus_4
					coalition_recognise_hrm_project_bonus_5
				}
				remove_from_tech_sharing_group = coalition_of_free_tech_share
			}
		}
	}
	on_capitulation = {
		effect = {
			log = "[GetDateText]: FROM: [From.GetName] ROOT: [Root.GetName] on_capitulation"
			FROM = {
				save_global_event_target_as = winning_country
			}
			ROOT = {
				save_global_event_target_as = losing_country
			}
			if = {
				limit = {
					ROOT = { tag = NLR }
					FROM = {
						OR = {
							is_SOLAR_EMPIRE = yes
							is_in_faction_with = event_target:solar_empire
						}
					}
				}
				if = {
					limit = { 
						NLR = {
							has_country_leader = {
								ruling_only = yes
								name = "Nightmare Moon"
							}
						}
					}
					EQS = { 
						clr_country_flag = paxsolaris_338_luna
						set_country_flag = paxsolaris_338_nmm
						country_event = paxsolaris.338 
					}
				}
				if = {
					limit = { 
						NLR = {
							has_country_leader = {
								ruling_only = yes
								name = "Luna"
							}
						}
					}
					EQS = {
						clr_country_flag = paxsolaris_338_nmm
						set_country_flag = paxsolaris_338_luna
						country_event = paxsolaris.338 
					}
				}
				if = {
					limit = { 
						NOT = {
							AND = {
								EQR = { has_capitulated = no } 
								NLR = { is_in_faction_with = EQR }
							}
						}
					}
					every_state = {
						remove_core_of = NLR
						remove_claim_by = NLR
					}
					every_country = {
						limit = {
							is_in_faction_with = NLR
							NOT = {
								tag = NLR
								tag = EQR
							}
						}
						if = {
							limit = { has_war_with = event_target:solar_empire }
							set_country_flag = { flag = bypass_on_peaceconference_ended days = 1 value = 1 }
							white_peace = event_target:solar_empire
							every_enemy_country = {
								limit = {
									is_in_faction_with = event_target:solar_empire
								}
								white_peace = ROOT
							}
						}
					}
					if = {
						limit = {
							EQR = { has_capitulated = yes } 
						}
						every_state = {
							remove_core_of = EQR
							remove_claim_by = EQR
						}
						every_country = {
							limit = {
								is_in_faction_with = EQR
								NOT = {
									tag = NLR
									tag = EQR
								}
							}
							if = {
								limit = { has_war_with = event_target:solar_empire }
								set_country_flag = { flag = bypass_on_peaceconference_ended days = 1 value = 1 }
								white_peace = event_target:solar_empire
								every_enemy_country = {
									limit = {
										is_in_faction_with = event_target:solar_empire
									}
									white_peace = ROOT
								}
							}
						}	
					}
				}
			}
			if = {
				limit = {
					ROOT = { tag = EQR }
					FROM = {
						OR = {
							is_SOLAR_EMPIRE = yes
							is_in_faction_with = event_target:solar_empire
						}
					}
				}
				if = {
					limit = { 
						NOT = {
							AND = {
								NLR = { has_capitulated = no } 
								EQR = { is_in_faction_with = NLR }
							}
						}
					}
					if = {
						limit = {
							NLR = { has_capitulated = yes } 
						}
						every_state = {
							remove_core_of = NLR
							remove_claim_by = NLR
						}
						every_country = {
							limit = {
								is_in_faction_with = NLR
								NOT = {
									tag = NLR
									tag = EQR
								}
							}
							if = {
								limit = { has_war_with = event_target:solar_empire }
								set_country_flag = { flag = bypass_on_peaceconference_ended days = 1 value = 1 }
								white_peace = event_target:solar_empire
								every_enemy_country = {
									limit = {
										is_in_faction_with = event_target:solar_empire
									}
									white_peace = ROOT
								}
							}
						}
					}
					every_state = {
						remove_core_of = EQR
						remove_claim_by = EQR
					}
					every_country = {
						limit = {
							is_in_faction_with = EQR
							NOT = {
								tag = NLR
								tag = EQR
							}
						}
						if = {
							limit = { has_war_with = event_target:solar_empire }
							set_country_flag = { flag = bypass_on_peaceconference_ended days = 1 value = 1 }
							white_peace = event_target:solar_empire
							every_enemy_country = {
								limit = {
									is_in_faction_with = event_target:solar_empire
								}
								white_peace = ROOT
							}
						}
					}
				}
			}
		}
	}
	on_puppet = {
		effect = {
			log = "[GetDateText]: ROOT: [Root.GetName] FROM: [From.GetName] on_puppet"
			if = {
				limit = { 
					FROM = { 
						is_SOLAR_EMPIRE = yes
					}
					OR = {
						ROOT = { 
							is_solar_core = yes
						}
						tag = DRG
					}
				}
				FROM = {
					annex_country = { target = ROOT  }
				}
			}
		}
	}
	on_daily = {
		effect = {
			if = {
				limit = {
					is_coalition_member = yes
					is_faction_leader = yes
					any_allied_country = {
						has_capitulated = no
					}
					NOT = { has_idea = SOL_coalition_surrender }
				}
				add_ideas = SOL_coalition_surrender
			}
		}
	}
	on_startup = {
		effect = {
			SOL_calculate_race = yes
		}
	}
}